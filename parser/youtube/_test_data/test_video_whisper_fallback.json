{
  "testCase": {
    "name": "this was genuinely interesting",
    "videoURL": "https://www.youtube.com/watch?v=jO9RSppTirQ",
    "description": "May need whisper fallback",
    "skipInShortMode": true,
    "skipReason": "Whisper transcription is slow in CI"
  },
  "expectedOutput": {
    "title": "",
    "language": "en",
    "segments": [
      "[00:00:00] hackers got caught exploiting WhatsApp",
      "[00:00:02] supposedly and the chain they used is",
      "[00:00:04] really really interesting. So WhatsApp",
      "[00:00:06] fixes a vulnerability used in zeroclick",
      "[00:00:09] attacks. A zero-click attack is this",
      "[00:00:11] thing where an attacker can literally",
      "[00:00:14] without any user interaction get code",
      "[00:00:16] control on your phone remotely. What",
      "[00:00:18] makes it scary with an app like WhatsApp",
      "[00:00:20] is WhatsApp is an application that",
      "[00:00:22] allows you to receive messages from",
      "[00:00:23] anybody. So a zero-click attack in",
      "[00:00:26] WhatsApp means that anybody who can send",
      "[00:00:28] you a WhatsApp message can get code",
      "[00:00:30] execution on your phone, steal your data",
      "[00:00:33] and live in your device. It's a very",
      "[00:00:34] scary place to be. Now the actual",
      "[00:00:37] vulnerability that got exploited here is",
      "[00:00:38] not a vulnerability in WhatsApp. There",
      "[00:00:40] is a vulnerability in WhatsApp, but it",
      "[00:00:42] was changed together with another",
      "[00:00:44] vulnerability in the entirety of Apple's",
      "[00:00:47] image processing. A lot of really weird",
      "[00:00:49] stuff going on in this chain. So,",
      "[00:00:50] WhatsApp security advisories, this came",
      "[00:00:52] out in August of this year, but the the",
      "[00:00:54] bugs are recently getting changed",
      "[00:00:55] together from a threat intelligence",
      "[00:00:56] standpoint. Incomplete authorization of",
      "[00:00:59] linked devices synchronization messages",
      "[00:01:02] in WhatsApp for iOS allowed a user that",
      "[00:01:05] is unrelated to process content from an",
      "[00:01:08] arbitrary URL on the targets device.",
      "[00:01:11] When you have WhatsApp devices, right,",
      "[00:01:13] these devices can be synchronized",
      "[00:01:15] between, you know, your iPhone and your",
      "[00:01:18] MacBook for example, right? and the",
      "[00:01:20] contents of those two things are",
      "[00:01:21] synchronized. They're related. Now,",
      "[00:01:23] because of an issue within WhatsApp",
      "[00:01:25] within the codebase, there was a way,",
      "[00:01:27] and I don't know the details of this. I",
      "[00:01:28] think the WhatsApp security team is",
      "[00:01:29] keeping it pretty pretty quiet. There",
      "[00:01:31] was a way for an attacker to make your",
      "[00:01:34] computer process content from an",
      "[00:01:36] arbitrary URL, which means that if it",
      "[00:01:38] sent you an image, it would go download",
      "[00:01:40] the image and view it. If you sent it a",
      "[00:01:42] website, it would go run the code on the",
      "[00:01:44] website, like the JavaScript, for",
      "[00:01:45] example. Now, a bug like this isn't",
      "[00:01:48] super interesting if there isn't an",
      "[00:01:50] underlying vulnerability. If you",
      "[00:01:51] actually look at the CVE for this, this",
      "[00:01:53] CVE only got a 5.4 CVSS score, right?",
      "[00:01:57] Which makes sense because like this in",
      "[00:01:59] itself, this vulnerability that allows",
      "[00:02:01] you to process content on a remote",
      "[00:02:03] computer is not like the code execution",
      "[00:02:06] that an elite hacker would want. They",
      "[00:02:08] need to get this to work another",
      "[00:02:11] vulnerability in a parser that they can",
      "[00:02:13] execute, right? For example, if I made",
      "[00:02:16] your phone download a picture, wouldn't",
      "[00:02:19] it be cool if I could also send you a",
      "[00:02:21] picture that triggered a vulnerability",
      "[00:02:23] in the image processing library? Well,",
      "[00:02:26] this is exactly what happened in this",
      "[00:02:27] vulnerability. So, this bug got",
      "[00:02:30] publicized around the same time that",
      "[00:02:32] Apple submitted a patch for their image",
      "[00:02:35] IO library. Now, like any good company",
      "[00:02:38] that has to maintain code, that has to",
      "[00:02:40] pay employees to keep a code base alive,",
      "[00:02:42] Apple uses this thing called image IO,",
      "[00:02:44] which is literally just a framework that",
      "[00:02:47] the entirety of iOS depends on to parse",
      "[00:02:50] and render images. Right? When your",
      "[00:02:52] phone or when any device that you use",
      "[00:02:54] really, your browser, your computer",
      "[00:02:55] included, when any of these devices",
      "[00:02:57] encounter an image, it is required that",
      "[00:03:00] they have to go and open the image and",
      "[00:03:02] parse the image to figure out what to",
      "[00:03:04] show you, right? And there's a lot of",
      "[00:03:06] binary metadata inside these images that",
      "[00:03:09] shows you different components of the",
      "[00:03:11] image. Like even in a very simple bit",
      "[00:03:13] map, right? You have the BMP file, but",
      "[00:03:16] it has elements in it like how big is",
      "[00:03:18] the size of the image, how wide is it,",
      "[00:03:20] how tall is it? And code somewhere in",
      "[00:03:22] your phone or your computer has to read",
      "[00:03:25] into this structure, pull all the data",
      "[00:03:27] out and allocate memory and move pieces",
      "[00:03:29] around to show you the graphics. And so",
      "[00:03:32] for Apple, the image IO library is what",
      "[00:03:35] does this. But just like anything,",
      "[00:03:36] right, the image IO library is code. And",
      "[00:03:40] code, like anything else, can have",
      "[00:03:41] vulnerabilities. And guys, while we",
      "[00:03:43] can't stop zero days from happening, one",
      "[00:03:45] thing we can do to stay ahead of cyber",
      "[00:03:47] actors is to use today's sponsor, Flare.",
      "[00:03:49] Flare is a threat exposure management",
      "[00:03:51] platform that allows you to see if you",
      "[00:03:53] or your company's personal data has been",
      "[00:03:55] breached and talked about and sold. From",
      "[00:03:57] Telegram leaks to info malware, Flare",
      "[00:04:00] has it all. Now, I'm actually using",
      "[00:04:02] Flare here to see if any of my business",
      "[00:04:03] identifiers have been compromised. I",
      "[00:04:05] have my email address here, and I have",
      "[00:04:06] Lowle Academy put into here as well. I",
      "[00:04:08] actually got a really scary event. I It",
      "[00:04:10] got sent to my email address. It said",
      "[00:04:11] there's a medium credential leak on",
      "[00:04:13] Lowle Academy and the only Low-level",
      "[00:04:15] Academy email address that exists is my",
      "[00:04:17] personal email address. So, I'm like,",
      "[00:04:18] "Oh, is my is my site going to get",
      "[00:04:20] hacked?" Now, luckily for me, unluckily",
      "[00:04:22] for somebody else, um what actually",
      "[00:04:24] happened is somebody's computer got",
      "[00:04:27] hacked that had a cookie for the Level",
      "[00:04:29] Academy in it. Right. But what this",
      "[00:04:30] means is that Flare is constantly",
      "[00:04:32] looking in these stealer logs and in",
      "[00:04:34] these Telegram chats and if any of the",
      "[00:04:36] content they find hits your identifiers,",
      "[00:04:38] they will send you a notification. Kind",
      "[00:04:40] of scared the crap out of me when it",
      "[00:04:41] happened, but it was good to know that",
      "[00:04:42] Flare had my back and was watching out",
      "[00:04:44] for me and sent me an email when",
      "[00:04:46] something weird happened. And what's",
      "[00:04:47] crazy is that Flare literally collects",
      "[00:04:48] millions of events per day. On the 10th",
      "[00:04:50] of September, they collected 12 million",
      "[00:04:53] events. That's a lot of hacks. If you",
      "[00:04:54] want to check and see if your",
      "[00:04:55] credentials or sensitive data are",
      "[00:04:56] hanging on the dark web. You can use my",
      "[00:04:58] URL right here to get a free trial of",
      "[00:04:59] Flare, go check it out, guys. The best",
      "[00:05:01] way to support me on this YouTube",
      "[00:05:03] channel or go to interact with the",
      "[00:05:04] sponsors, go use their products and see",
      "[00:05:06] if you can use them in your day-to-day.",
      "[00:05:07] Thanks again, Flair, for sponsoring this",
      "[00:05:09] video. Back to the video. And so, enter",
      "[00:05:11] the vulnerability here. This is CV",
      "[00:05:13] 202543300.",
      "[00:05:15] It is an 1861 zeroclick rce proof of",
      "[00:05:19] concept here. Again, the the whole crux",
      "[00:05:21] of this is zero click r. makes this even",
      "[00:05:24] scarier than the WhatsApp bug which is",
      "[00:05:26] chained with this supposedly is that if",
      "[00:05:29] I were to show you literally just",
      "[00:05:32] present to you you on your phone via",
      "[00:05:34] iMessage via AirDrop via web browser",
      "[00:05:37] this image right an image that takes",
      "[00:05:39] advantage of a vulnerability in image IO",
      "[00:05:41] because your phone or your computer or",
      "[00:05:43] whatever has to process that image it is",
      "[00:05:46] required to process that image it will",
      "[00:05:48] just automatically process the picture",
      "[00:05:50] take the code path that has a",
      "[00:05:52] vulnerability and get code execution on",
      "[00:05:54] on your computer, right? These kinds of",
      "[00:05:56] parsing bugs are a hacker's wet dream,",
      "[00:05:59] dude. They are absolutely insane. Now,",
      "[00:06:01] obviously, in a codebase as not only",
      "[00:06:04] complex, but as guarded as apples,",
      "[00:06:06] right, they're extremely hard to",
      "[00:06:08] exploit. But if a nation state or some",
      "[00:06:10] other, you know, like NSO group type",
      "[00:06:12] group can do it, then, you know, it's a",
      "[00:06:14] scary place to be. So, what is the",
      "[00:06:16] nature of this vulnerability? Well, it",
      "[00:06:18] all comes down to the RAW camera bundle,",
      "[00:06:20] a component within the image IO",
      "[00:06:22] framework. It has to do with the DNG",
      "[00:06:25] file format, a file, a file format that",
      "[00:06:27] I'm actually I didn't know existed until",
      "[00:06:28] I'm working on this video. Uh the DNG",
      "[00:06:30] standing for digital negative",
      "[00:06:32] supposedly. It is an open lossless raw",
      "[00:06:35] image format. If you're not aware, a lot",
      "[00:06:36] of image formats like PNG or JPEG, for",
      "[00:06:39] example, are loss C, which means that",
      "[00:06:41] when you have an image either via your",
      "[00:06:43] camera or your image editor, those files",
      "[00:06:45] are very large. Like a 4K image in RAW",
      "[00:06:48] is a ton of data. To pass that around on",
      "[00:06:50] the internet, we made image formats that",
      "[00:06:52] are compressed, meaning they compress",
      "[00:06:54] down some of the information to a place",
      "[00:06:55] where it's not necessary for you to see",
      "[00:06:57] it. So the image is not uh in its raw",
      "[00:07:00] format, but it looks generally the same.",
      "[00:07:02] Now for people that are doing either",
      "[00:07:03] audiovisisual work or photography work,",
      "[00:07:05] they need to have images that are",
      "[00:07:06] lossless, which means that they don't",
      "[00:07:08] lose any information. The reason why I'm",
      "[00:07:10] highlighting this is because from the",
      "[00:07:12] world of memory corruption",
      "[00:07:14] vulnerabilities, from the world of",
      "[00:07:15] finding bugs in software, it's very",
      "[00:07:17] common for new bugs to be found in code",
      "[00:07:21] that is less commonly used or less",
      "[00:07:23] highly audited. Right? I'm sure the",
      "[00:07:26] image IO framework code for PNG or for",
      "[00:07:29] bit map, right? two of like the biggest",
      "[00:07:31] uh image formats in in the world are",
      "[00:07:33] highly audited and highly taken care of.",
      "[00:07:35] Whereas Image io's DNG, right, a format",
      "[00:07:38] I haven't heard of until just now may be",
      "[00:07:39] less seen. So, it makes sense to me that",
      "[00:07:41] a bug was found here versus there. Now,",
      "[00:07:43] the group uh Quarkslab did an amazing",
      "[00:07:46] write up on this vulnerability. I'm not",
      "[00:07:47] going to read through this. I'm not",
      "[00:07:48] going to like just do the the article",
      "[00:07:50] read thing for you. Please go to their",
      "[00:07:51] the write up, read it yourself. A lot of",
      "[00:07:52] really good information here. I do want",
      "[00:07:54] to go over kind of like the main thing",
      "[00:07:56] that they bring up in the uh in the",
      "[00:07:58] write up which is like they write a",
      "[00:08:00] pseudo code snippet of code that shows",
      "[00:08:02] you the vulnerability and why it exists.",
      "[00:08:05] Basically because of the way that the",
      "[00:08:08] DNG format works, there are multiple",
      "[00:08:11] pieces that are called components and",
      "[00:08:13] there are different things called",
      "[00:08:14] samples per pixel and there is a mix a",
      "[00:08:17] mismatch in the code between the actual",
      "[00:08:21] number of components that exist and what",
      "[00:08:23] is assumed by the code. Right? So there",
      "[00:08:25] there's this code path you can go down",
      "[00:08:27] that if the samples per pixel in the",
      "[00:08:29] image is two but the number of",
      "[00:08:32] components is not two it will",
      "[00:08:34] automatically assume by this time two",
      "[00:08:37] here it should be a times number of",
      "[00:08:38] components that there are two components",
      "[00:08:40] right but because the buffer is not big",
      "[00:08:42] enough meaning it did not allocate",
      "[00:08:44] enough room it only allocated enough for",
      "[00:08:46] one component and not two when it goes",
      "[00:08:49] to uncompress your image it's going to",
      "[00:08:51] begin to write data for the image as it",
      "[00:08:54] decompresses is outside of the buffer",
      "[00:08:56] and this enables what is called an",
      "[00:08:57] out-of-bounds right and a right that",
      "[00:08:59] allows you as the attacker to put data",
      "[00:09:01] somewhere on the computer that isn't in",
      "[00:09:03] your control right this is like the",
      "[00:09:04] hacker's wet dream right you either",
      "[00:09:06] exploit you know a buffer that gives you",
      "[00:09:08] control of the return address or the",
      "[00:09:09] ability to put data elsewhere that you",
      "[00:09:11] can take advantage of and before you go",
      "[00:09:13] and and on Apple for like not",
      "[00:09:14] testing their code right as the",
      "[00:09:16] conclusion here says image formats are",
      "[00:09:18] tricky vulnerabilities and parsers are",
      "[00:09:20] not so uncommon and when they happen",
      "[00:09:22] they're usually very valuable however",
      "[00:09:24] the image is processed when received. No",
      "[00:09:26] user interaction is needed. You can send",
      "[00:09:27] it via SMS, iMessage, etc. Like this is",
      "[00:09:30] extremely common, right? The the world",
      "[00:09:33] of parsers where they take data from a",
      "[00:09:36] user and have to render it or parse it",
      "[00:09:38] and the the threat model is that anyone",
      "[00:09:41] can send you this stuff. So they become",
      "[00:09:42] a very common attack surface. The reason",
      "[00:09:44] why I'm not surprised that another image",
      "[00:09:46] format has a vulnerability in it. We had",
      "[00:09:48] a bug uh that got caught the the NSO",
      "[00:09:50] group using I think it was called blast",
      "[00:09:51] pass, right? the webm bug from like two",
      "[00:09:53] or three years ago. It's so hard to",
      "[00:09:56] trigger these vulnerabilities in in fuzz",
      "[00:09:58] testing because a lot of them have these",
      "[00:10:00] weird edge cases where you have to have",
      "[00:10:03] certain parameters that meet a certain",
      "[00:10:04] set of of requirements like you know you",
      "[00:10:06] have number of components is two but",
      "[00:10:07] samples per pixel is only one or vice",
      "[00:10:09] versa. But also some of these depend on",
      "[00:10:12] compression, right? So if you are trying",
      "[00:10:15] to fuzz and create an image that is",
      "[00:10:17] decompressing into a state where the",
      "[00:10:19] program crashes, if you don't get the",
      "[00:10:21] compression right, it's not going to",
      "[00:10:23] decompress properly and you're not going",
      "[00:10:24] to get the crash that you want. We",
      "[00:10:26] actually had the same issue with the",
      "[00:10:27] WebM bug from a while ago. So Blast Pass",
      "[00:10:30] was another vulnerability that was",
      "[00:10:31] caught being used supposedly by the NSO",
      "[00:10:33] groups. NSO group is an Israeli",
      "[00:10:35] intelligence firm that sells",
      "[00:10:36] vulnerabilities. Um, and so what was",
      "[00:10:38] happening is that this message got",
      "[00:10:40] caught being sent around to an iMessage",
      "[00:10:42] and they were sending people a webm a a",
      "[00:10:45] picture that exploited a vulnerability",
      "[00:10:47] in the lib webp project a very widely",
      "[00:10:50] used kind of used by everybody um image",
      "[00:10:52] processing library similar to image io",
      "[00:10:54] but even worse because like this is used",
      "[00:10:56] everywhere it's used in chrome it's used",
      "[00:10:57] in firefox etc right and so because of",
      "[00:11:00] the way that the webp format works you",
      "[00:11:03] have to have these things called huffman",
      "[00:11:04] trees which basically encode compression",
      "[00:11:06] information for the image. And when",
      "[00:11:08] you're fuzz testing, right, you're doing",
      "[00:11:10] coverageguided fuzzing and you're kind",
      "[00:11:12] of randomly mutating data to figure out",
      "[00:11:14] how far into the code graph you can get.",
      "[00:11:17] But to exploit the vulnerability that",
      "[00:11:19] Blast Pass exploited, you had to create",
      "[00:11:22] a very specific, very large Huffman tree",
      "[00:11:26] that could not have been created",
      "[00:11:27] randomly, right? There's no way to",
      "[00:11:28] randomly test for this, which is why",
      "[00:11:31] bugs like this didn't get caught. And",
      "[00:11:32] similar to the digital negative format",
      "[00:11:34] we're seeing for this vulnerability,",
      "[00:11:35] it's just another issue where it's so",
      "[00:11:37] difficult to randomly generate these",
      "[00:11:40] images and have them be correct that",
      "[00:11:41] you're likely going to miss edge cases",
      "[00:11:43] in your fuzz testing. So at the end of",
      "[00:11:45] the day, right, this vulnerability in",
      "[00:11:47] DNG was being used to send to people on",
      "[00:11:50] WhatsApp and then the WhatsApp",
      "[00:11:51] vulnerability would allow anybody to",
      "[00:11:53] parse these URLs and because of that",
      "[00:11:55] hackers were doing evil and nefarious",
      "[00:11:57] stuff. It's a it's a crazy world out",
      "[00:11:58] there, guys. I love these kinds of bugs.",
      "[00:12:00] Not from like an attacker like people",
      "[00:12:02] getting hacked standpoint. It's just",
      "[00:12:03] really interesting to see not only like",
      "[00:12:06] two bugs getting chained and like",
      "[00:12:08] company A seeing it and company B seeing",
      "[00:12:10] it, but also like very sophisticated",
      "[00:12:13] vulnerabilities where they're exploiting",
      "[00:12:15] bugs and like image parsers. Like those",
      "[00:12:17] to me are just really neat",
      "[00:12:18] vulnerabilities. Anyway guys, um on",
      "[00:12:21] Friday of this week in my next video,",
      "[00:12:22] I'll make a video on the the way that",
      "[00:12:24] Apple plans on actually stopping a lot",
      "[00:12:26] of vulnerabilities from happening in",
      "[00:12:28] general. It's called Apple's Memory",
      "[00:12:29] Integrity Enforcement. We will see you",
      "[00:12:31] in that next video.",
    ]
  }
}
